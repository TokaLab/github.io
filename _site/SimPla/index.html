<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>SimPla - Simulated Plasma -</title>
<meta name="description" content="Here we will put the short description of our project">


  <meta name="author" content="Here we can put the authors">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="SimPla - Simulated Plasma">
<meta property="og:url" content="http://localhost:4000/SimPla/">


  <meta property="og:description" content="Here we will put the short description of our project">











  

  


<link rel="canonical" href="http://localhost:4000/SimPla/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->


  </head>

  <body class="layout--splash">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/Logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/Documentation/"
                
                
              >Documentation</a>
            </li><li class="masthead__menu-item">
              <a
                href="/Publications/"
                
                
              >Publications</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


<!-- Here we have our image -->
    
<style>
      /* Default Styles */
      .hero-section {
        background-image: url('/assets/images/G3_zoom2.png');
        background-size: cover;
        background-position: center;
        width: 100%;
        height: 50vh; /* Default height */
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
      }
    
      /* For Smaller Screens (Mobile) */
      @media (max-width: 768px) {
        .hero-section {
          height: 20vh; /* Reduced height for smaller screens */
        }
    
        .hero-section h1 {
          font-size: 1rem; /* Make the title smaller on mobile */
        }
      }
    </style>

    <div class="hero-section">
      <h1 style="color: white; font-size: 3rem; z-index: 10;"></h1>
    </div>

    
<!-- other things -->
    
    <div class="initial-content">
      <script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>



<div id="main" role="main">
  <article class="splash" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="SimPla - Simulated Plasma">
    
    
    

    <section class="page__content" itemprop="text">
      <script type="text/javascript" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

<h1 id="simpla---simulated-plasma">SimPla - Simulated Plasma</h1>

<p>SimPla is a tool for simulating plasma behavour using a single-fluid model in a tokamak, for example to solve a plasma equilibrium problem.</p>

<h2 id="matlab-guide">MATLAB Guide</h2>

<p>In case you need to solve a plasma equilibrium problem, please open <strong>Main_equilibrium.m</strong>.</p>

<h3 id="example-1-solve-an-iter-like-configuration">EXAMPLE 1: SOLVE AN ITER-LIKE CONFIGURATION</h3>

<p>First steps require to define essential geometrical and plasma parameters of your configuration.</p>

<p>All geometrical parameters are collected in a structure called <code class="language-plaintext highlighter-rouge">Geo</code> . In <strong>Main_equilibrium.m</strong>, we define first two geometrical parameters:</p>

<ul>
  <li>
    <p>major radius: <code class="language-plaintext highlighter-rouge">Geo.R0 = 6</code> [m]</p>
  </li>
  <li>
    <p>minor radius: <code class="language-plaintext highlighter-rouge">Geo.a = 2</code> [m]</p>
  </li>
</ul>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">%% Define Geometry (Geo)</span>

<span class="n">Geo</span><span class="o">.</span><span class="n">R0</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="n">Geo</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</code></pre></div></div>

<p>All plasma equilibrium parameters are collected in the structure <code class="language-plaintext highlighter-rouge">Equi</code>, more specifically in its substructure <code class="language-plaintext highlighter-rouge">Equi.Config.param</code>.</p>

<p>Open <strong>Equilibrium_boundary.m</strong>, where you can input desired parameters through the function <strong>Equi_type_Jt_I_Config.m</strong> or by uploading your own file containing all data.</p>

<p>So, let’s now open <strong>Equi_type_Jt_I_Config.m</strong>.</p>

<p>First plasma equilibrium parameters are related to the desired plasma shape (for a better understanding, please refer to <strong>Appendix A</strong>), and they are:</p>

<ul>
  <li>
    <p>upper elongation: <code class="language-plaintext highlighter-rouge">Equi.Config.param.k1 = 1.7</code></p>
  </li>
  <li>
    <p>lower elongation: <code class="language-plaintext highlighter-rouge">Equi.Config.param.k2 = 2</code></p>
  </li>
  <li>
    <p>upper triangularity: <code class="language-plaintext highlighter-rouge">Equi.Config.param.d1 = 0.5</code></p>
  </li>
  <li>
    <p>lower triangularity: <code class="language-plaintext highlighter-rouge">Equi.Config.param.d2 = 0.5</code></p>
  </li>
  <li>
    <p>upper inner angle: <code class="language-plaintext highlighter-rouge">Equi.Config.param.gamma_n_1 = 0</code> [radians]</p>
  </li>
  <li>
    <p>lower inner angle: <code class="language-plaintext highlighter-rouge">Equi.Config.param.gamma_n_2 = pi/3</code> [radians]</p>
  </li>
  <li>
    <p>upper outer angle: <code class="language-plaintext highlighter-rouge">Equi.Config.param.gamma_p_1 = 0</code> [radians]</p>
  </li>
  <li>
    <p>lower outer angle: <code class="language-plaintext highlighter-rouge">Equi.Config.param.gamma_p_2 = pi/6</code> [radians]</p>
  </li>
</ul>

<p>Other parameters are related to the plasma current profile and magnetic field:</p>

<ul>
  <li>
    <p>total plasma current <code class="language-plaintext highlighter-rouge">Equi.Config.param.Ip = -10e6</code> [A]</p>
  </li>
  <li>
    <p>plasma profile coefficient $β_0$: <code class="language-plaintext highlighter-rouge">Equi.Config.param.beta0 = 0.5</code></p>
  </li>
  <li>
    <p>plasma profile coefficient $α_1$: <code class="language-plaintext highlighter-rouge">Equi.Config.param.alpha1 = 2</code></p>
  </li>
  <li>
    <p>plasma profile coefficient $α_2$: <code class="language-plaintext highlighter-rouge">Equi.Config.param.alpha2 = 2</code></p>
  </li>
  <li>
    <p>toroidal magnetic field on axis: <code class="language-plaintext highlighter-rouge">Equi.Config.param.Bt0 = 5</code>;</p>
  </li>
</ul>

<p>And lastly, parameters related to the numerical solver:</p>

<ul>
  <li>
    <p>Maximum number of iterations: <code class="language-plaintext highlighter-rouge">Equi.Config.param.Max_iter = 30</code></p>
  </li>
  <li>
    <p>Stop condition on convergence error: <code class="language-plaintext highlighter-rouge">Equi.Config.param.Error_conv = 1e-5</code></p>
  </li>
</ul>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">Equi</span> <span class="o">=</span> <span class="n">Equi_type_Jt_I_Config</span><span class="p">()</span>

<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">k1</span> <span class="o">=</span> <span class="mf">1.7</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">d1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">d2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">gamma_n_1</span> <span class="o">=</span> <span class="nb">pi</span><span class="p">/</span><span class="mi">9</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">gamma_n_2</span> <span class="o">=</span> <span class="nb">pi</span><span class="p">/</span><span class="mi">3</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">gamma_p_1</span> <span class="o">=</span> <span class="nb">pi</span><span class="p">/</span><span class="mi">8</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">gamma_p_2</span> <span class="o">=</span> <span class="nb">pi</span><span class="p">/</span><span class="mi">6</span><span class="p">;</span>

<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">Ip</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10e6</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">Bt0</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">Max_iter</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">Error_conv</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">beta0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">alpha1</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">Equi</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">alpha2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="k">end</span>
</code></pre></div></div>

<p>Now, let’s return to <em>Main_equilibrium.m</em> and let’s run the code. 
<span style="font-size: 40px; color: green;">
  <i class="fas fa-play-circle"></i>
</span></p>

<p>All equilibrium quantities are computed and stored in <code class="language-plaintext highlighter-rouge">Equi</code> structure.</p>

<p>Now, we can see a plot of the poloidal flux $ψ$ [Wb/radians] <code class="language-plaintext highlighter-rouge">(Equi.psi)</code>.</p>

<p align="center">
  <img src="/assets/images/SimPla_convergence_solution.png" alt="Solution Convergence" width="100%" />
</p>

<p>We can also see the Last Closed Flux Surface (<code class="language-plaintext highlighter-rouge">Equi.LCFS.R</code>, <code class="language-plaintext highlighter-rouge">Equi.LCFS.Z</code>) and highlight the coordinates of the magnetic axis (<code class="language-plaintext highlighter-rouge">Equi.Opoint_R</code>, <code class="language-plaintext highlighter-rouge">Equi.Opoint_Z</code>) and the X point (<code class="language-plaintext highlighter-rouge">Equi.Xpoint_R</code>, <code class="language-plaintext highlighter-rouge">Equi.Xpoint_Z</code>).</p>

<p align="center">
  <img src="/assets/images/SimPla_LCFS.png" alt="LCFS" width="60%" />
</p>

<p>Once you normalise the poloidal flux $ψ_n$ (see <strong>Equilibrium_normalise.m</strong>), you can derive all MHD fields (<code class="language-plaintext highlighter-rouge">Equi.Bt</code>, <code class="language-plaintext highlighter-rouge">Equi. Br</code>, <code class="language-plaintext highlighter-rouge">Equi.Bz</code>, <code class="language-plaintext highlighter-rouge">Equi.Jt</code>, <code class="language-plaintext highlighter-rouge">Equi. Jr</code>, <code class="language-plaintext highlighter-rouge">Equi.Jz</code>) and kinetic fields (<code class="language-plaintext highlighter-rouge">Equi.p</code>, <code class="language-plaintext highlighter-rouge">Equi.n</code>, <code class="language-plaintext highlighter-rouge">Equi.T</code>).</p>

<p>Use <strong>Equilibrium_MHD_Fields.m</strong> function if you are interested in retrieving MHD fields and <strong>Equilibrium_KineticProfiles.m</strong> function if you are interested in kinetic fields.</p>

<p><strong>Attention:</strong> before computing kinetic fields, you need to input some parameters on your plasma density profile:</p>

<ul>
  <li>
    <p>peak plasma density $n_0$: <code class="language-plaintext highlighter-rouge">Equi.Config.param_kinetic.n0 = 1e20</code> [$m^-3$]</p>
  </li>
  <li>
    <p>plasma density on the separatrix $n_{sep}$: <code class="language-plaintext highlighter-rouge">Equi.Config.param_kinetic.nsep = 1e17</code> []</p>
  </li>
  <li>
    <p>density profile double-power exponent $a_1$: <code class="language-plaintext highlighter-rouge">Equi.Config.param_kinetic.a1 = 6</code></p>
  </li>
  <li>
    <p>density profile double-power exponent $a_2$: <code class="language-plaintext highlighter-rouge">Equi.Config.param_kinetic.a2 = 3</code></p>
  </li>
</ul>

<p>Here are some examples of the kinetic profiles <strong>n, p</strong> and <strong>T</strong> vs $\boldsymbol{\psi}_n$.</p>

<p align="center">
  <img src="/assets/images/SimPla_kinetic_profiles.png" alt="Kinetics Profiles" width="50%" />
</p>

<p>We can now also have a look at all fields that we have retrieved from the equilibrium solution.</p>

<p align="center">
  <img src="/assets/images/SimPla_MHD_fields.png" alt="MHD fields" width="70%" />
</p>

<h3 id="appendix-a">APPENDIX A</h3>

<p>Our reference to the parametrisation of the plasma shape is:</p>

<p><strong>J. Johner, 2011, HELIOS: a zero-dimensional tool for next step and reactor studies, Fusion Sci. Technol. 59 (February) 308–349.</strong></p>

<p>Here is a basic illustration of all parameters needed for the parametrisation of the desired plasma shape. Differently from our reference, angles were denoted with $\gamma$ instead of $\psi$ to avoid misinterpretation with the poloidal flux.</p>

<p align="center">
  <img src="/assets/images/SimPla_parametrisation.png" alt="Parametrisation" width="60%" />
</p>

<p><strong>Cross-section parametrisation:</strong></p>

<p>Normalised Cylindrical Coordinates:</p>

<ul>
  <li>$ \xi =  \frac{R-R_0}{a} $</li>
  <li>$ \zeta =  \frac{Z}{a} $</li>
</ul>

<p>Parameters:</p>

<ul>
  <li>$ \delta_1 = $ upper triangularity</li>
  <li>$ \delta_2 = $ lower triangularity</li>
  <li>$ \kappa_1 = $ upper elongation</li>
  <li>$ \kappa_2 = $ lower elongation</li>
  <li>$ \gamma^-_1 = $ inner upper angle</li>
  <li>$ \gamma^-_2 = $ inner lower angle</li>
  <li>$ \gamma^+_1 = $ outer upper angle</li>
  <li>$ \gamma^+_2 = $ outer lower angle</li>
</ul>

<p>Shape example 1: <strong>Single X point</strong> ($ \gamma^-_1 = \gamma^+_1 = 0° $)</p>

<p align="center">
  <img src="/assets/images/SimPla_parametrisationITER.png" alt="Parametrisation ITER" width="35%" />
</p>

<p>The reference for plasma toroidal current density profile is:</p>

<p><strong>Coleman M. and McIntosh S., 2020, The design and optimisation of tokamak poloidal field systems in the BLUEPRINT framework, Fusion Eng. Des. 154 111544</strong></p>

<p>Where $J_t$ is defined as:</p>

\[J_t =
\begin{cases}
\lambda \left( \beta_0 \cdot \frac{R}{R_0} + (1 - \beta_0) \cdot \frac{R_0}{R} \right) \cdot \left(1 - \psi_n^{\alpha_1}\right)^{\alpha_2} &amp; \text{for } 0 &lt; \psi_n &lt; 1 \\
0 &amp; \text{elsewhere}
\end{cases}\]

<p>$ψ_n$ is the normalised poloidal flux $\psi_n = \frac{\psi-\psi_0}{\psi_{sep}-\psi_0}$</p>

<p>$λ$ and $β_0$ are parameters that affect the plasma current integral value. The shape of the profile chosen is a double power function of the normalised poloidal flux and $α_1$ and $α_2$ are the exponents of such double power function.</p>

<h2 id="python-guide">Python Guide</h2>

<p>Progresses about this guide will be released in the next future.</p>


    </section>
  </article>
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 <a href="http://localhost:4000"></a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









  </body>
</html>
